$$.user={roundTime:0,status:"stop",selectedColor:"deepskyblue",renderPoint:function(e){$("#userPoint").html(e[$$.userId])},getPoint:function(){$.ajax({type:"get",url:"/state/point",success:function(e){$$.user.renderPoint(e.points)},error:function(){alert("Admin: Error when get point setting!")}})},renderRound1:function(e){"send"==e.action?($$.user.question=e.question,$("#questionContent").html("").css("display","none"),$(".answer").html("").css("display","none").css("background-color","#f5f5f5").css("color","red"),$("#questionResult").css("display","none"),$("#userDeltaPoint").css("display","none"),$("#countdown1").css("display","none")):$$.user.question.index==e.questionIndex&&($("#questionContent").html($$.user.question.content).css("display","block"),$("#answerA").html("A. "+$$.user.question.answerA).css("display","block").css("color","red"),$("#answerB").html("B. "+$$.user.question.answerB).css("display","block").css("color","red"),$("#answerC").html("C. "+$$.user.question.answerC).css("display","block").css("color","red"),$("#answerD").html("D. "+$$.user.question.answerD).css("display","block").css("color","red"),$("#questionResult").css("display","result"==e.action?"block":"none").html(e.answer?e.answer.answer.toUpperCase():""),$("#userDeltaPoint").css("display","result"==e.action?"block":"none").html(e.answer?e.answer.point:""),$("#countdown1").css("display","block"),e.answer&&$("#answer"+e.answer.answer.toUpperCase()).css("background-color",$$.screen.selectedColor).css("color","white"),"show"==e.action?($$.user.roundTime=Math.round(e.remainTime/1e3),$$.user.status="stop"):"start"==e.action?($$.user.roundTime=Math.round(e.remainTime/1e3),$$.user.status="start"):($$.user.roundTime=0,$$.user.status="stop")),$.ajax({type:"PUT",url:"/user/round1/question/"+$$.user.question.index,success:function(e){e.error&&alert("User: "+error)},error:function(){alert("User: Report question has error!")}})},getRound1:function(){1==$$.user.roundIndex&&$.ajax({type:"GET",url:"/admin/round1/state",success:function(e){$$.user.question=e.question,$$.user.renderRound1(e),console.log(e)},error:function(){alert("User: "+$$.capitalizeFirstLetter(action)+" question "+questionIndex+"!")}})},getRound:function(){$.ajax({type:"get",url:"/state/round",success:function(e){$$.user.roundIndex=e.round,$$.user.getRound1()},error:function(){alert("User: Error when get round setting!")}})},getTime:function(){$.ajax({type:"get",url:"/state/time",success:function(e){$$.user.round1Time=e.round1},error:function(){alert("Admin: Error when get time setting!")}})},round1Select:function(e){var s=(e=$(e)).attr("data-value").trim().toLowerCase(),r=Math.round($$.user.roundTime);$.ajax({type:"PUT",url:"/user/round1/answer/"+$$.user.question.index+"/"+s+"/"+r+"?t="+(new Date).getTime(),success:function(s){s.error?$$.alert("User: "+s.error+"!"):($(".answer").css("background-color","#f5f5f5").css("color","red"),e.css("background-color",$$.user.selectedColor).css("color","white"))},error:function(){alert("User: Send answer has errors!")}})},init:function(){$$.socket.emit("login",$$.userId),$("#userAvatar").attr("src","/img/user/"+$$.userId+".png"),$("#countdown1").flipcountdown({tick:function(){return"start"==$$.user.status&&$$.user.roundTime--,$$.user.roundTime<=0&&($$.user.roundTime=0,$$.user.status),function(e){return e>9||e<-9?e:"0"+e}($$.user.roundTime)}}),$$.user.getRound(),$$.user.getPoint(),$$.user.getTime(),$$.socket.on("round",function(e){$$.user.renderRound(e)}),$$.socket.on("point",function(e){$$.user.renderPoint(e)}),$$.socket.on("round1Do",function(e){$$.user.getRound1()})}},$(document).ready($$.user.init);