$$.screen={roundTime:0,status:"stop",selectedColor:"deepskyblue",renderPoint:function(e){Object.keys(e).forEach(function(n){$("#userRound"+$$.screen.roundIndex+"Box #userPoint"+n).html("Point: "+e[n]),$("#pointContainer #userPoint"+n).html("Điểm: "+e[n])})},getPoint:function(){$.ajax({type:"get",url:"/state/point",success:function(e){$$.screen.renderPoint(e.points)},error:function(){alert("Admin: Error when get point setting!")}})},playAudioTick:function(){document.getElementById("audioTick").play()},stopAudioTick:function(){var e=document.getElementById("audioTick");e.pause(),e.currentTime=0},playAudioAlarm:function(){document.getElementById("audioAlarm").play()},renderRound1:function(e){"send"==e.action?($$.screen.question=e.question,$("#questionContainer").css("display","block"),$("#questionContent").html("").css("display","none"),$(".answer").html("").css("display","none").css("background-color","#f5f5f5").css("color","red"),$("#questionResult").css("display","none"),$("#countDown").css("display","none")):$$.screen.question.index==e.questionIndex&&($("#questionContainer").css("display","block"),$("#questionContent").html($$.screen.question.content).css("display","block"),$("#answerA").html("A. "+$$.screen.question.answerA).css("display","block"),$("#answerB").html("B. "+$$.screen.question.answerB).css("display","block"),$("#answerC").html("C. "+$$.screen.question.answerC).css("display","block"),$("#answerD").html("D. "+$$.screen.question.answerD).css("display","block"),$("#tableCountDown").css("display","block"),$("#countDown").css("display","block"),e.result&&$("#answer"+e.result.toUpperCase()).css("background-color",$$.screen.selectedColor).css("color","white"),console.log(e),"show"==e.action?($$.screen.roundTime=Math.round(e.remainTime/1e3),$$.screen.status="stop",$$.screen.stopAudioTick()):"start"==e.action?($$.screen.roundTime=Math.round(e.remainTime/1e3),$$.screen.status="start",$$.screen.playAudioTick()):($$.screen.status="stop",$$.screen.stopAudioTick()))},getRound1:function(){$.ajax({type:"GET",url:"/admin/round1/state?t="+(new Date).getTime(),success:function(e){$$.screen.question=e.question,$$.screen.renderRound1(e)},error:function(){alert("Screen: "+$$.capitalizeFirstLetter(action)+" question "+questionIndex+"!")}})},renderRound2:function(e){""!=e&&($("#countDown").css("display","block"),$(".userRound2").attr("src","/img/user/"+e+".png"),$(".pointUserRound2").attr("id","userPoint"+e),$$.screen.getPoint())},getRound2:function(){$.ajax({type:"get",url:"/state/round2User",success:function(e){e.error?alert("Screen: Error when get round2 user! "+e.error):$$.screen.renderRound2(e.round2User)},error:function(){alert("Screen: Error when get round2 user!")}})},renderRound3:function(e){""!=e&&($("#countDown").css("display","block"),""!=e.round3User1&&($(".userRound3-1").attr("src","/img/user/"+e.round3User1+".png"),$(".pointUserRound3-1").attr("id","userPoint"+e.round3User1)),""!=e.round3User2&&($(".userRound3-2").attr("src","/img/user/"+e.round3User2+".png"),$(".pointUserRound3-2").attr("id","userPoint"+e.round3User2)),""!=e.round3User3&&($(".userRound3-3").attr("src","/img/user/"+e.round3User3+".png"),$(".pointUserRound3-3").attr("id","userPoint"+e.round3User3)),""!=e.round3User4&&($(".userRound3-4").attr("src","/img/user/"+e.round3User4+".png"),$(".pointUserRound3-4").attr("id","userPoint"+e.round3User4)),$$.screen.getPoint())},getRound3:function(){$.ajax({type:"get",url:"/state/round3User",success:function(e){e.error?alert("Screen: Error when get round3 user! "+e.error):$$.screen.renderRound3(e)},error:function(){alert("Screen: Error when get round3 user!")}})},renderRound4:function(e){""!=e&&(console.log(e),""!=e.round4User1&&($(".userRound4-2").attr("src","/img/user/"+e.round4User1+".png"),$(".pointUserRound4-2").attr("id","userPoint"+e.round4User1)),""!=e.round4User2&&($(".userRound4-3").attr("src","/img/user/"+e.round4User2+".png"),$(".pointUserRound4-3").attr("id","userPoint"+e.round4User2)),$$.screen.getPoint())},getRound4:function(){$.ajax({type:"get",url:"/state/round4User",success:function(e){e.error?alert("Screen: Error when get round4 user! "+e.error):$$.screen.renderRound4(e)},error:function(){alert("Screen: Error when get round4 user!")}})},renderRound:function(e){$$.screen.roundIndex=e,$(".round").css("display","none"),$("#round"+$$.screen.roundIndex).css("display","inline-block"),$("#minus").css("display","none"),1==$$.screen.roundIndex?$$.screen.getRound1():2==$$.screen.roundIndex?$$.screen.getRound2():3==$$.screen.roundIndex?$$.screen.getRound3():4==$$.screen.roundIndex&&$$.screen.getRound4()},getRound:function(){$.ajax({type:"get",url:"/state/round",success:function(e){1<=e.round&&e.round<=4&&($$.screen.renderRound(e.round),$$.screen.getPoint(),$$.screen.getTime(e.round))},error:function(){alert("Screen: Error when get round setting!")}})},getTime:function(e){$.ajax({type:"get",url:"/state/time",success:function(n){2<=e&&e<=4&&($$.screen.status="stop",$$.screen.roundTime=n["round"+e])},error:function(){alert("Screen: Error when get round time setting!")}})},renderScreen:function(e){$(".round").css("display","none"),$("#tableCountDown").css("display","none"),$("#pointContainer").css("display","none"),"question"==e?($("#tableCountDown").css("display","block"),$$.screen.getRound()):($("#pointContainer").css("display","block"),$$.screen.getPoint(),$$.screen.getQuestionsState())},getScreen:function(){$.ajax({type:"get",url:"/state/screen",success:function(e){$$.screen.renderScreen(e.screen.toLowerCase())},error:function(){alert("Admin: Error when get screen setting!")}})},renderQuestionsState:function(e){$(".userChoice").html(""),Object.keys(e.answers).forEach(function(n){console.log(e.answers[n]),$("#userChoice"+n).html(e.answers[n].answer.toUpperCase())})},getQuestionsState:function(){$.ajax({type:"GET",url:"/state/questions",success:function(e){$$.screen.renderQuestionsState(e)},error:function(){alert("Error: get questions state!")}})},init:function(){$$.screen.getScreen(),$("#countDown").flipcountdown({tick:function(){var e=function(e){return e>9||e<-9?e:"0"+e};"start"==$$.screen.status&&$$.screen.roundTime--;var n=$$.screen.roundTime,r=n%86400%3600%60,s=e(parseInt(n%86400%3600/60))+" "+e(r);return 0==$$.screen.roundTime&&void 0!=$$.screen.roundIndex&&(1==$$.screen.roundIndex||3==$$.screen.roundIndex||4==$$.screen.roundIndex?("start"==$$.screen.status&&$$.screen.playAudioAlarm(),$$.screen.status="stop",$$.screen.stopAudioTick()):$("#minus").css("display","block")),s}}),$$.socket.on("screen",function(e){$$.screen.renderScreen(e.toLowerCase())}),$$.socket.on("round",function(e){$$.screen.getTime(e),$$.screen.renderRound(e),$$.screen.getPoint()}),$$.socket.on("point",function(e){$$.screen.renderPoint(e)}),$$.socket.on("round1Do",function(e){1==$$.screen.roundIndex&&$$.screen.getRound1()}),$$.socket.on("round2User",function(e){$$.screen.renderRound2(e.round2User)}),$$.socket.on("questions_state",function(e){console.log(e)}),$$.socket.on("user_choice",function(e){if(1==$$.screen.roundIndex&&"start"==$$.screen.status){document.getElementById("audioChoice"+e.user).play()}})}},$(document).ready($$.screen.init);