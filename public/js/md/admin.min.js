$$.admin={selectScreen:function(e){$.ajax({type:"put",url:"/state/screen/"+e,success:function(e){e.error&&alert("Admin: "+e.error)},error:function(){alert("Admin: Error when get round setting!")}})},renderScreen:function(e){$(".round1Screen").attr("checked",null).parent().removeClass("active"),$("#round1Screen"+$$.capitalizeFirstLetter(e)).attr("checked","").parent().addClass("active")},getScreen:function(){$.ajax({type:"get",url:"/state/screen",success:function(e){$$.admin.renderScreen(e.screen.toLowerCase())},error:function(){alert("Admin: Error when get screen setting!")}})},renderOnline:function(e){for(var t=0;t<e.length;t++)e[t]?$("#userStatus"+t).addClass("badge-success").removeClass("badge-default"):$("#userStatus"+t).addClass("badge-default").removeClass("badge-success")},getOnline:function(){$.ajax({type:"GET",url:"/state/online",success:function(e){$$.admin.renderOnline(e)},error:function(){alert("Error: get online data!")}})},renderQuestionsState:function(e){Object.keys(e.questions).forEach(function(t){var n=e.questions[t],r=e.answers[t],o=!(void 0==r||null==r),a=o?" => "+r.answer.toUpperCase()+r.time:"",i=$("#userQuestion"+t).attr("data-question",n).html("Q"+n+a);o&&i.attr("data-answer",r.answer).attr("data-answer-time",r.time)})},getQuestionsState:function(){$.ajax({type:"GET",url:"/state/questions",success:function(e){$$.admin.renderQuestionsState(e)},error:function(){alert("Error: get questions state!")}})},selectRound:function(e){e=$(e),$$.confirm("Change round",'Are you sure you want to change round "<b>'+e.html()+'</b>"?',function(){var t=$("#menuRound"),n=e.attr("data-value");$.ajax({type:"put",url:"/state/round",data:{key:"round",value:n},dataType:"JSON",success:function(r){r.error?alert(r.error):t.attr("data-value",n).html(e.html())},error:function(){alert("Admin: Error when get round setting!")}})})},getRound:function(){$.ajax({type:"get",url:"/state/round",success:function(e){var t=$("#menuRound"),n=t.next().children().eq(e.round);t.attr("data-value",e.round).html(n.html()),1==e.round&&$.ajax({type:"GET",url:"/admin/round1/state",success:function(e){$("#round1QuestionIndex").html("Question: "+e.action+" "+e.questionIndex)},error:function(){alert("Error: "+$$.capitalizeFirstLetter(action)+" question "+questionIndex+"!")}})},error:function(){alert("Admin: Error when get round setting!")}})},setPoint:function(e,t){var n=$(e).parent().parent(),r=n.attr("data-username"),o=n.children().eq(1).children().eq(0).val();$.ajax({type:"put",url:"/state/point",data:{username:r,point:o*t},dataType:"JSON",success:function(e){e.error&&alert("Admin: Error when set point!")},error:function(){alert("Admin: Error when set point!")}})},renderPoint:function(e){Object.keys(e).forEach(function(t){$("#userPoint"+t).html("Point: "+e[t])})},getPoint:function(){$.ajax({type:"get",url:"/state/point",success:function(e){$$.admin.renderPoint(e.points)},error:function(){alert("Admin: Error when get point setting!")}})},setTime:function(e){var t=$("#roundTime"+e).val();try{t=parseInt(t)}catch(e){t=-1}t<0?alert("Admin: Invalid time!"):$.ajax({type:"PUT",url:"/state/time/"+e+"/"+t,success:function(t){t.error?alert("Error: set time of round "+e+"! "+t.error):alert("Success: set time of round "+e+"!")},error:function(){alert("Error: set time of round "+e+"!")}})},getTime:function(){$.ajax({type:"get",url:"/state/time",success:function(e){e.round1&&$("#roundTime1").val(e.round1),e.round2&&$("#roundTime2").val(e.round2),e.round3&&$("#roundTime3").val(e.round3),e.round4&&$("#roundTime4").val(e.round4)},error:function(){alert("Admin: Error when get time setting!")}})},round1Do:function(e,t){var n=$(e).parent().attr("data-value");$.ajax({type:"PUT",url:"/admin/round1/"+t+"/"+n,success:function(e){e.error&&alert("Error: "+$$.capitalizeFirstLetter(t)+" question "+n+"! "+e.error)},error:function(){alert("Error: "+$$.capitalizeFirstLetter(t)+" question "+n+"!")}})},init:function(){$("#menuHome").append('<span class="sr-only">(current)</span>').parent().addClass("active"),$$.admin.getScreen(),$$.admin.getOnline(),$$.admin.getQuestionsState(),$$.admin.getRound(),$$.admin.getPoint(),$$.admin.getTime(),$$.socket.on("screen",function(e){$$.admin.renderScreen(e.toLowerCase())}),$$.socket.on("online",function(e){$$.admin.renderOnline(e)}),$$.socket.on("questions_state",function(e){$$.admin.renderQuestionsState(e)}),$$.socket.on("point",function(e){$$.admin.renderPoint(e)}),$$.socket.on("round1Do",function(e){$("#round1QuestionIndex").html("Question: "+e.action+" "+e.questionIndex)})}},$(document).ready($$.admin.init);