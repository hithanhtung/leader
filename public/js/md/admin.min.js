$$.admin={selectScreen:function(r){$.ajax({type:"put",url:"/state/screen/"+r,success:function(r){r.error&&alert("Admin: "+r.error)},error:function(){alert("Admin: Error when get round setting!")}})},renderScreen:function(r){$(".round1Screen").attr("checked",null).parent().removeClass("active"),$("#round1Screen"+$$.capitalizeFirstLetter(r)).attr("checked","").parent().addClass("active")},getScreen:function(){$.ajax({type:"get",url:"/state/screen",success:function(r){$$.admin.renderScreen(r.screen.toLowerCase())},error:function(){alert("Admin: Error when get screen setting!")}})},renderOnline:function(r){for(var e=0;e<r.length;e++)r[e]?$("#userStatus"+e).addClass("badge-success").removeClass("badge-default"):$("#userStatus"+e).addClass("badge-default").removeClass("badge-success")},getOnline:function(){$.ajax({type:"GET",url:"/state/online",success:function(r){$$.admin.renderOnline(r)},error:function(){alert("Error: get online data!")}})},renderQuestionsState:function(r){Object.keys(r.questions).forEach(function(e){var n=r.questions[e],t=r.answers[e],o=!(void 0==t||null==t),u=o?" => "+t.answer.toUpperCase():"",a=$("#userQuestion"+e).attr("data-question",n).html("Q"+n+u);o&&($("#userDeltaPoint"+e).val(t.point),a.attr("data-answer",t.answer).attr("data-point",t.point))})},getQuestionsState:function(){$.ajax({type:"GET",url:"/state/questions",success:function(r){$$.admin.renderQuestionsState(r)},error:function(){alert("Error: get questions state!")}})},selectRound:function(r){r=$(r),$$.confirm("Change round",'Are you sure you want to change round "<b>'+r.html()+'</b>"?',function(){var e=$("#menuRound"),n=r.attr("data-value");$.ajax({type:"put",url:"/state/round",data:{key:"round",value:n},dataType:"JSON",success:function(t){t.error?alert(t.error):e.attr("data-value",n).html(r.html())},error:function(){alert("Admin: Error when get round setting!")}})})},getRound:function(){$.ajax({type:"get",url:"/state/round",success:function(r){var e=$("#menuRound"),n=e.next().children().eq(r.round);e.attr("data-value",r.round).html(n.html()),1==r.round&&$.ajax({type:"GET",url:"/admin/round1/state",success:function(r){$("#round1QuestionIndex").html("Question: "+r.action+" "+r.questionIndex)},error:function(){alert("Error: "+$$.capitalizeFirstLetter(action)+" question "+questionIndex+"!")}})},error:function(){alert("Admin: Error when get round setting!")}})},setAllPoints:function(r){$$.confirm("Set all point","Are you sure?",function(){$.ajax({type:"put",url:"/state/all_point/"+r,success:function(e){e.error?alert("Admin: Error when set all points!"):$(".userDeltaPoint").val(r)},error:function(){alert("Admin: Error when set all points!")}})})},setPoint:function(r,e){var n=$(r).parent().parent(),t=n.attr("data-username"),o=n.children().eq(1).children().eq(0).val();$.ajax({type:"put",url:"/state/point",data:{username:t,point:o*e},dataType:"JSON",success:function(r){r.error&&alert("Admin: Error when set point!")},error:function(){alert("Admin: Error when set point!")}})},renderPoint:function(r){Object.keys(r).forEach(function(e){$("#userPoint"+e).html("Point: "+r[e])})},getPoint:function(){$.ajax({type:"get",url:"/state/point",success:function(r){$$.admin.renderPoint(r.points)},error:function(){alert("Admin: Error when get point setting!")}})},setTime:function(r){var e=$("#roundTime"+r).val();try{e=parseInt(e)}catch(r){e=-1}e<0?alert("Admin: Invalid time!"):$.ajax({type:"PUT",url:"/state/time/"+r+"/"+e,success:function(e){e.error?alert("Error: set time of round "+r+"! "+e.error):alert("Success: set time of round "+r+"!")},error:function(){alert("Error: set time of round "+r+"!")}})},getTime:function(){$.ajax({type:"get",url:"/state/time",success:function(r){r.round1&&$("#roundTime1").val(r.round1),r.round2&&$("#roundTime2").val(r.round2),r.round3&&$("#roundTime3").val(r.round3),r.round4&&$("#roundTime4").val(r.round4)},error:function(){alert("Admin: Error when get time setting!")}})},round1Do:function(r,e){var n=$(r).parent().attr("data-value");$.ajax({type:"PUT",url:"/admin/round1/"+e+"/"+n,success:function(r){r.error&&alert("Error: "+$$.capitalizeFirstLetter(e)+" question "+n+"! "+r.error)},error:function(){alert("Error: "+$$.capitalizeFirstLetter(e)+" question "+n+"!")}})},renderRound2User:function(r){$(".button-start2").removeClass("badge-warning").addClass("badge-default"),$("#userRound2"+r).addClass("badge-warning")},getRound2User:function(){$.ajax({type:"get",url:"/state/round2User",success:function(r){r.error?alert("Admin: Error when get round2 user! "+r.error):$$.admin.renderRound2User(r.round2User)},error:function(){alert("Admin: Error when get round2 user!")}})},startRound2:function(r){$.ajax({type:"PUT",url:"/state/round2User/"+r,success:function(e){e.error?alert("Error: "+r+" start round 2! "+e.error):$$.admin.renderRound2User(r)},error:function(){alert("Error: "+r+" start round 2!")}})},stopRound2:function(){$.ajax({type:"DELETE",url:"/state/round2User/",success:function(r){r.error?alert("Error: "+username+" start round 2! "+r.error):$$.admin.renderRound2User(username)},error:function(){alert("Error: "+username+" start round 2!")}})},renderRound3User:function(r){$("#round3User1").val(r.round3User1),$("#round3User2").val(r.round3User2),$("#round3User3").val(r.round3User3),$("#round3User4").val(r.round3User4)},getRound3User:function(){$.ajax({type:"get",url:"/state/round3User",success:function(r){r.error?alert("Admin: Error when get round3 user! "+r.error):$$.admin.renderRound3User(r)},error:function(){alert("Admin: Error when get round3 user!")}})},setRound3User:function(r){var e=$("#round3User"+r).val();$.ajax({type:"PUT",url:"/state/round3User/"+r+"/"+e,success:function(r){r.error&&alert("Error: "+e+" start round 3! "+r.error)},error:function(){alert("Error: "+e+" start round 3!")}})},renderRound4User:function(r){$("#round4User1").val(r.round4User1),$("#round4User2").val(r.round4User2)},getRound4User:function(){$.ajax({type:"get",url:"/state/round4User",success:function(r){r.error?alert("Admin: Error when get round4 user! "+r.error):$$.admin.renderRound4User(r)},error:function(){alert("Admin: Error when get round4 user!")}})},setRound4User:function(r){var e=$("#round4User"+r).val();$.ajax({type:"PUT",url:"/state/round4User/"+r+"/"+e,success:function(r){r.error&&alert("Error: "+e+" start round 4! "+r.error)},error:function(){alert("Error: "+e+" start round 4!")}})},init:function(){$("#menuHome").append('<span class="sr-only">(current)</span>').parent().addClass("active"),$$.admin.getScreen(),$$.admin.getOnline(),$$.admin.getQuestionsState(),$$.admin.getRound(),$$.admin.getPoint(),$$.admin.getTime(),$$.admin.getRound2User(),$$.admin.getRound3User(),$$.admin.getRound4User(),$$.socket.on("screen",function(r){$$.admin.renderScreen(r.toLowerCase())}),$$.socket.on("online",function(r){$$.admin.renderOnline(r)}),$$.socket.on("questions_state",function(r){$$.admin.renderQuestionsState(r)}),$$.socket.on("point",function(r){console.log("point",r),$$.admin.renderPoint(r)}),$$.socket.on("round1Do",function(r){$("#round1QuestionIndex").html("Question: "+r.action+" "+r.questionIndex)}),$$.socket.on("round2User",function(r){$$.admin.renderRound2User(r.round2User)}),$$.socket.on("round3User",function(){$$.admin.getRound3User()}),$$.socket.on("round4User",function(){$$.admin.getRound4User()})}},$(document).ready($$.admin.init);